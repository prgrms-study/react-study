# 1.16 useEffectë¥¼ ì‚¬ìš©í•˜ì—¬ ë§ˆìš´íŠ¸/ì–¸ë§ˆìš´íŠ¸/ì—…ë°ì´íŠ¸ì‹œ í•  ì‘ì—… ì„¤ì •í•˜ê¸°
[ğŸì°¸ê³  - useEffect ì™„ë²½ ê°€ì´ë“œğŸ](https://rinae.dev/posts/a-complete-guide-to-useeffect-ko)

ìš©ì–´ ì •ë¦¬
- ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë‚˜íƒ€ë‚¬ì„ ë•Œ : ë§ˆìš´íŠ¸
- ì»´í¬ë„ŒíŠ¸ê°€ ì‚¬ë¼ì§ˆ ë•Œ : ì–¸ë§ˆìš´íŠ¸
- ì»´í¬ë„ŒíŠ¸ì˜ íŠ¹ì • propsê°€ ë°”ë€” ë•Œ : ì—…ë°ì´íŠ¸

ë§ˆìš´íŠ¸ ì‹œ í•˜ëŠ” ì‘ì—…ë“¤
- `props` ë¡œ ë°›ì€ ê°’ì„ ì»´í¬ë„ŒíŠ¸ì˜ ë¡œì»¬ ìƒíƒœë¡œ ì„¤ì •
- ì™¸ë¶€ API ìš”ì²­ (REST API ë“±)
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© (D3, Video.js ë“±...)
- `setInterval` ì„ í†µí•œ ë°˜ë³µì‘ì—… í˜¹ì€ `setTimeout` ì„ í†µí•œ ì‘ì—… ì˜ˆì•½

ì–¸ë§ˆìš´íŠ¸ ì‹œ í•˜ëŠ” ì‘ì—…ë“¤
- `setInterval`, `setTimeout` ì„ ì‚¬ìš©í•˜ì—¬ ë“±ë¡í•œ ì‘ì—…ë“¤ clear í•˜ê¸° (`clearInterval`, `clearTimeout`)
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¸ìŠ¤í„´ìŠ¤ ì œê±°

useEffect
```js
useEffect(() => {      // í•¨ìˆ˜A
  console.log('A');
  return () => {       // í•¨ìˆ˜B
    console.log('B')
  };
}, []);
```
- ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” í•¨ìˆ˜, ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” ì˜ì¡´ê°’ì´ ë“¤ì–´ìˆëŠ” ë°°ì—´(`deps`)ì„ ë„£ëŠ”ë‹¤.
- useEffectê°€ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜Bê°€ `cleanup í•¨ìˆ˜`ì´ê³ , `useEffect` ì— ëŒ€í•œ ë’·ì •ë¦¬ë¥¼ í•´ì¤€ë‹¤.
- `useEffect` ì•ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ìƒíƒœë‚˜, `props` ê°€ ìˆë‹¤ë©´, `useEffect` ì˜ `deps` ì— ê°’ì„ ë„£ì–´ì£¼ì–´ì•¼ í•©
  - ë„£ì§€ ì•Šì„ ê²½ìš°, í•¨ìˆ˜A ì‹¤í–‰ ì‹œ ìµœì‹  `props`/ìƒíƒœë¥¼ ê°€ë¥´í‚¤ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤.

deps
  - ë¹ˆë°°ì—´
    - ë§ˆìš´íŠ¸ ì‹œì—ë§Œ í•¨ìˆ˜A í˜¸ì¶œ
    - ì–¸ë§ˆìš´íŠ¸ ì‹œì—ë§Œ í•¨ìˆ˜B í˜¸ì¶œ
  - ì˜ì¡´ê°’ ì¡´ì¬
    - ë§ˆìš´íŠ¸ ì‹œì™€ ì˜ì¡´ê°’ ë³€ê²½ ì‹œ í•¨ìˆ˜A í˜¸ì¶œ
    - ì–¸ë§ˆìš´íŠ¸ ì‹œì™€ ê°’ì´ ë°”ë€Œê¸° ì§ì „ì— í•¨ìˆ˜B í˜¸ì¶œ
  - ì•„ì˜ˆ ìƒëµ
    - ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë  ë•Œë§ˆë‹¤ í•¨ìˆ˜A í˜¸ì¶œ

# 1.17 useMemo ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ì‚°í•œ ê°’ ì¬ì‚¬ìš©í•˜ê¸°
useMemo
  - ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ì—°ì‚°ëœ ê°’ì„ ì¬ì‚¬ìš©í•œë‹¤.
  - ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” ì–´ë–»ê²Œ ì—°ì‚°í• ì§€ ì •ì˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë„£ê³  ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” `deps` ë°°ì—´ì„ ë„£ëŠ”ë‹¤.
  - `deps` ê°’ì´ ë°”ë€Œë©´ ë“±ë¡í•œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì„œ ê°’ì„ ì—°ì‚°í•œë‹¤.
  - `deps` ê°’ì´ ë°”ë€Œì§€ ì•Šìœ¼ë©´ ì´ì „ì— ì—°ì‚°í•œ ê°’ì„ ì¬ì‚¬ìš©í•œë‹¤.

```js
// App.js
function countActiveUsers(users) {
  console.log('í™œì„± ì‚¬ìš©ì ìˆ˜ë¥¼ ì„¸ëŠ”ì¤‘...');
  return users.filter(user => user.active).length;
}

function App() {
  //...
  const count = useMemo(() => countActiveUsers(users), [users])
}
;
```

# 1.18 useCallback ì„ ì‚¬ìš©í•˜ì—¬ í•¨ìˆ˜ ì¬ì‚¬ìš©í•˜ê¸°
`useMemo` ëŠ” íŠ¹ì • **ê²°ê³¼ê°’ì„ ì¬ì‚¬ìš©** í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë°˜ë©´, `useCallback` ì€ íŠ¹ì • **í•¨ìˆ˜ë¥¼ ì¬ì‚¬ìš©**í•˜ê³  ì‹¶ì„ë•Œ ì‚¬ìš©í•œë‹¤.

`onCreate`, `onRemove`, `onToggle` í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë  ë•Œ ë§ˆë‹¤ ìƒˆë¡œ ë§Œë“¤ì–´ì§„ë‹¤.
ì»´í¬ë„ŒíŠ¸ì—ì„œ `props` ê°€ ë°”ë€Œì§€ ì•Šì•˜ìœ¼ë©´ Virtual DOM ì— ìƒˆë¡œ ë Œë”ë§í•˜ëŠ” ê²ƒ ì¡°ì°¨ í•˜ì§€ ì•Šê³  ì»´í¬ë„ŒíŠ¸ì˜ ê²°ê³¼ë¬¼ì„ ì¬ì‚¬ìš© í•˜ëŠ” ìµœì í™” ì‘ì—… í•˜ê¸°

useCallback
```js
const onCreate = () => {
  const user = {
      id: nextId.current,
      username,
      email,
    }

    //usersë°°ì—´ì— ì¶”ê°€
    setUsers([...users, user]);

    //inputs ê°’ ë¹„ìš°ê¸°
    setInputs({
      username: '',
      email: ''
    });

    // nextId ì—…ë°ì´íŠ¸
    nextId.current += 1;
};
```
```js
const onCreate = useCallback(() => {
  /* ... */
}, [users, username, email]);
```
- í•¨ìˆ˜ ì•ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ìƒíƒœ/`props` ê°€ ìˆë‹¤ë©´ ê¼­, `deps` ë°°ì—´ì•ˆì— í¬í•¨ì‹œì¼œì•¼ ëœë‹¤.
- `props` ë¡œ ë°›ì•„ì˜¨ í•¨ìˆ˜ë„ `deps` ì— ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤.

useCallbackì„ useMemoë¡œ ë°”ê¿”ë³´ê¸°
```js
const onToggle = useCallback(
  () => {
    /* ... */
  },
  [users]
);
```
```js
const onToggle = useMemo(
  () => () => {
    /* ... */
  },
  [users]
);
```

`useCallback`ì„ ì‚¬ìš© í•¨ìœ¼ë¡œì¨, ë°”ë¡œ ì´ë¤„ë‚¼ìˆ˜ ìˆëŠ” ëˆˆì— ë„ëŠ” ìµœì í™”ëŠ” ì—†ë‹¤. `React.memo`ë¡œ ë Œë”ë§ ìµœì í™” ì‘ì—…ì„ í•´ì•¼í•œë‹¤.

# 1.19 React.memo ë¥¼ ì‚¬ìš©í•œ ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë”ë§ ë°©ì§€
ì»´í¬ë„ŒíŠ¸ì˜ `props` ê°€ ë°”ë€Œì§€ ì•Šì•˜ë‹¤ë©´, ë¦¬ë Œë”ë§ì„ ë°©ì§€í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ ì„±ëŠ¥ ìµœì í™”ë¥¼ í•œë‹¤.

ì‚¬ìš©ë²•ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ `React.memo`ë¡œ ê°ì‹¸ì£¼ë©´ ëœë‹¤.
```js
const CreateUser = () => {
  return (
    /* ... */
  );
}

export default React.memo(CreateUser);
```

í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸
- `useCallback()`ì„ ì ìš©í•œ `onCreate`, `onRemove`, `onToggle` í•¨ìˆ˜ê°€ `deps`ë¡œ `users`ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ë°°ì—´ì´ ë°”ë€”ë•Œë§ˆë‹¤ í•¨ìˆ˜ê°€ ìƒˆë¡œ ë§Œë“¤ì–´ì§€ê³  ìˆë‹¤.
  ```js
  const onCreate = useCallback(() => {
    /* ... */
    setUsers(users.concat(user));
    /* ... */
  }, [users, username, email]);
  ```
- `deps`ì—ì„œ `users`ë¥¼ ì§€ìš°ê³  í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸ë¥¼ í•œë‹¤.
- `setUsers` ì— ë“±ë¡í•˜ëŠ” ì½œë°±í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ì—ì„œ ìµœì‹  `users` ë¥¼ ì°¸ì¡° í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— `deps` ì— `users` ë¥¼ ë„£ì§€ ì•Šì•„ë„ ëœë‹¤.
  ```js
  const onCreate = useCallback(() => {
    /* ... */
    setUsers(users => users.concat(user));
    /* ... */
  }, [username, email]);
  ```

`React.memo` ì—ì„œ ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì— `propsAreEqual` ì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ê°’ë“¤ë§Œ ë¹„êµë¥¼ í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.
```js
export default React.memo(
  UserList,
  (prevProps, nextProps) => prevProps.users === nextProps.users
);
```

`useCallback`, `useMemo`, `React.memo` ëŠ” ì»´í¬ë„ŒíŠ¸ì˜ ì„±ëŠ¥ì„ ì‹¤ì œë¡œ ê°œì„ í• ìˆ˜ìˆëŠ” ìƒí™©ì—ì„œë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
- ë¶ˆí•„ìš”í•œ ë¹„êµ
- ë²„ê·¸ë°œìƒ

# 1.20 useReducer ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§ ë¶„ë¦¬í•˜ê¸°
ì§€ê¸ˆê¹Œì§€ ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” `useState`ì˜ setterí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì´ë¤„ì¡Œë‹¤.<br>
`useReducer`ë¡œë„ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆìœ¼ë©°, ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶„ë¦¬ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

reducer
- í˜„ì¬ ìƒíƒœì™€ ì•¡ì…˜ ê°ì²´ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì™€ì„œ ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
  ```js
  function reducer(state, action) {
    // ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë§Œë“œëŠ” ë¡œì§
    // const nextState = ...
    return nextState;
  }
  ```

useReducer
- useStateë¥¼ ì‚¬ìš©í•œ ê²½ìš°
  ```js
  function Counter() {
    const [number, setNumber] = useState(0);

    const onIncrease = () => {
      setNumber(prevNumber => prevNumber + 1);
    };
  }
  ```
- useReducerë¥¼ ì‚¬ìš©í•œ ê²½ìš°
  ```js
  function reducer(state, action) {
    switch (action.type) {
      case 'INCREMENT':
        return state + 1;
      case 'DECREMENT':
        return state - 1;
      default:
        return state;
    }
  }

  function Counter() {
    const [number, dispatch] = useReducer(reducer, 0);

    const onIncrease = () => {
      dispatch({ type: 'INCREMENT' });
    };
  }
  ```
  - state : ìƒíƒœ
  - dispatch : ì•¡ì…˜ì„ ë°œìƒì‹œí‚¤ëŠ” í•¨ìˆ˜
  - ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„° : reducer í•¨ìˆ˜
  - ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„° : ì´ˆê¸° ìƒíƒœ

useReducer vs useState
- useState
  - ê´€ë¦¬í•  ê°’ì´ í•˜ë‚˜ì´ê³ , ê·¸ ê°’ì´ ë‹¨ìˆœí•œ ìˆ«ì/ë¬¸ìì—´/boolean ê°’ ì¼ ê²½ìš°
- useReduce
  - ê´€ë¦¬í•  ê°’ì´ ì—¬ëŸ¬ê°œë¼ ìƒíƒœ êµ¬ì¡°ê°€ ë³µì¡í•´ì§ˆ ê²½ìš°

# 1.21 ì»¤ìŠ¤í…€ Hooks ë§Œë“¤ê¸°
- ë°˜ë³µë˜ëŠ” ë¡œì§ì„ ì»¤ìŠ¤í…€ Hookìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ë³´í†µ `use~~`ë¡œ íŒŒì¼ëª…ì„ ë§Œë“¤ê³  í•¨ìˆ˜ë¥¼ ì‘ì„±í•œë‹¤.
- ì—¬ëŸ¬ Hooksë¡œ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê³  ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•  ê°’ì„ ë°˜í™˜í•œë‹¤.


- ìƒˆë¡œìš´ í•­ëª©ì„ ì¶”ê°€ í•  ë•Œ `input` ê°’ì„ ì´ˆê¸°í™”í•´ì•¼ í•˜ë¯€ë¡œ ë°ì´í„° ë“±ë¡ í›„ `reset()` ì„ í˜¸ì¶œí•œë‹¤.
  ```js
  // Appì—ì„œ useInputs ì‚¬ìš©

  const [{ username, email }, onChange, reset] = useInputs({
    username: '',
    email: ''
  });

  const onCreate = useCallback(() => {
      dispatch({
        type: 'CREATE_USER',
        user: {
          id: nextId.current,
          username,
          email
        }
      });
      reset();                      // reset
      nextId.current += 1;
    }, [username, email, reset]);
  ```
